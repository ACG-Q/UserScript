<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Script Detail</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="container">
    <header>
      <h1>Script Detail</h1>
      <button id="backButton" class="back-button">← Back</button>
    </header>

    <main id="detailContent">
      <h2 id="detailTitle">IC千库网, 去登陆弹窗, 添加免VIP下载按钮, GIF图为无水印图</h2>

      
        <p><strong>namespace:</strong> Violentmonkey Scripts</p>
      
        <p><strong>match:</strong> https://588ku.com/*,https://www.58pic.com/*</p>
      
        <p><strong>grant:</strong> none,GM_download</p>
      
        <p><strong>version:</strong> 1.1</p>
      
        <p><strong>author:</strong> 六记</p>
      
        <p><strong>description:</strong> 2021/9/11 下午8:21:16</p>
      
        <p><strong>id:</strong> -c00-5-c000-a320-4a16-801c-ad21879a7b1e</p>
      
        <p><strong>filePath:</strong> scripts/图库下载.user.js</p>
      
        <p><strong>downloadLink:</strong> https://raw.githubusercontent.com/ACG-Q/UserScript/main/scripts/图库下载.user.js</p>
      

      <p><strong>content:</strong></p>
      <pre>// ==UserScript==
// @name        IC千库网, 去登陆弹窗, 添加免VIP下载按钮, GIF图为无水印图
// @namespace   Violentmonkey Scripts
// @match       https://588ku.com/*
// @match       https://www.58pic.com/*
// @grant       none
// @version     1.1
// @author      六记
// @grant       GM_download
// @description 2021/9/11 下午8:21:16
// ==/UserScript==
(() =&gt; {
  const mountNode = (btns, newBtn) =&gt; {
    return new Promise((resolve, reject) =&gt; {
      if (!btns || btns.length === 0) {
        reject();
      } else {
        btns.forEach((btn) =&gt; {
          let childNodes = btn.childNodes;
          childNodes.forEach((node) =&gt; {
            console.log(node);
            btn.removeChild(node);
          });
          btn.appendChild(newBtn);
        });
        resolve();
      }
    });
  };

  const getSuffix = (string) =&gt; {
    let suffix = string.split(&#34;.&#34;);
    suffix = suffix[suffix.length - 1];
    // 解决古怪的后缀
    if (suffix.indexOf(&#34;!&#34;)) {
      // img!adasd
      suffix = string.split(&#34;!&#34;);
      suffix = suffix[0];
    }

    return suffix;
  };

  let host = window.location.host;
  let loginFrames = &#34;&#34;;
  let btns = [];
  let inputBtn = document.createElement(&#34;a&#34;);
  inputBtn.innerText = &#34;免VIP下载图片&#34;;
  if (host.match(/588ku/i)) {
    // 登录弹窗
    loginFrames = document.querySelectorAll(&#34;.down-limit&#34;);
    inputBtn.className = &#34;fl Btn down-btn down-png&#34;;
    inputBtn.onclick = () =&gt; {
      let img = document.querySelector(&#34;.scaleImg&#34;);
      let imgSrc = img.src;
      let imgSuffix = getSuffix(imgSrc);
      let imgTitle = img.title;
      GM_download({
        url: imgSrc,
        name: `${imgTitle}.${imgSuffix}`,
        onload: (data) =&gt; {
          console.log(data);
          console.log(`成功下载${imgTitle}.${imgSuffix}`);
        },
        onerror: (err) =&gt; {
          console.log(err);
          console.log(`下载${imgTitle}.${imgSuffix}失败`);
        },
      });
    };
    btns = document.querySelectorAll(&#34;.clearfix .btns-box&#34;);
  } else if (host.match(/58pic/i)) {
    // 登录弹窗
    loginFrames = document.querySelectorAll(&#34;.login-model&#34;);
    inputBtn.className = &#34;detailBtn-down download-page qtw-show-btn fl&#34;;
    inputBtn.onclick = () =&gt; {
      let img = document.querySelectorAll(&#34;.show-area-pic.loading_space_img&#34;);
      img = img[img.length - 1];
      let imgSrc = img.src;
      let imgSuffix = getSuffix(imgSrc);
      let imgTitle = img.title;
      GM_download({
        url: imgSrc,
        name: `${imgTitle}.${imgSuffix}`,
        onload: (data) =&gt; {
          console.log(data);
          console.log(`成功下载${imgTitle}.${imgSuffix}`);
        },
        onerror: (err) =&gt; {
          console.log(err);
          console.log(`下载${imgTitle}.${imgSuffix}失败`);
        },
      });
    };
    btns = document.querySelectorAll(&#34;.show-download-row&#34;);
  }
  // 去登录弹窗
  if (loginFrames) loginFrames.forEach((frame) =&gt; frame.remove());
  // 挂载按钮
  mountNode(btns, inputBtn)
    .then(() =&gt; {
      console.log(&#34;成功挂载按钮到[&#34; + host + &#34;]网页&#34;);
    })
    .catch(() =&gt; {
      console.log(&#34;挂载按钮失败&#34;);
    });
})();
</pre>
    </main>
  </div>

  <script>
    // 返回首页
    document.getElementById('backButton').addEventListener('click', () => {
      window.history.back();
    });
  </script>
</body>
</html>